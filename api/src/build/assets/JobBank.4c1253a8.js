var B=Object.defineProperty;var L=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var F=(a,t,s)=>t in a?B(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,J=(a,t)=>{for(var s in t||(t={}))T.call(t,s)&&F(a,s,t[s]);if(L)for(var s of L(t))_.call(t,s)&&F(a,s,t[s]);return a};import{r as n,t as b}from"./vendor.b272e12a.js";import{u as P,j as r,a as e,L as S,b as p,h as x,c as E,A as I,F as A,p as M}from"./index.eb6b2ee8.js";import{m as D,u as z}from"./moment-with-locales.02939e25.js";import{M as G}from"./Modal.5fa20ae6.js";import{S as U}from"./sweetalert2.24b5b669.js";const q=({searchTerm:a,jobs:t,isLoading:s})=>{const{navigate:c,params:d}=P(),u=o=>{c(`/graduated/jobbank/job/${o.folio}`,{state:o})};return r("div",{children:[!t.filter(o=>o.vacante.toLowerCase().includes(a.toLowerCase())).length>0&&a.length>0&&r("h5",{className:"text-center text-primary",children:["No se encontraron resultados para: '",a,"''"]}),s?e(S,{}):t.length>0?t.filter(o=>o.vacante.toLowerCase().includes(a.toLowerCase())).map(o=>r("div",{onClick:()=>u(o),style:{cursor:"pointer"},className:`card rounded-0 pt-3 px-3 border-left-0 border-right-0   ${parseInt(d.id)===o.folio?"bg-green-light shadow ":""}`,children:[e("h5",{className:"text-primary font-weight-bolder",children:o.vacante}),r("div",{className:"d-flex flex-column",children:[e("span",{className:"text-truncate ",children:o.nombre_comercial}),e("span",{className:"text-truncate ",children:o.ubicacion})]}),r("div",{className:"d-flex justify-content-between align-items-end h-100 mt-2",children:[r("p",{style:{fontSize:"13px"},children:[e("span",{className:"text-primary font-weight-bold",children:"cv"})," ",r("span",{className:"text-primary font-weight-bold",children:["|"," ",e("span",{className:"badge badge-primary ",children:o.solicitudes})," ",o.solicitudes===1?"Solicitud":"Solicitudes"]})]}),e("p",{children:e("span",{className:"badge badge-primary ",children:D(o.fecha_creacion).locale("es").fromNow()})})]})]},o.folio)):e("h5",{className:"text-center",children:"Aqui apareceran los trabajos publicados recientemente"})]})},Q=async()=>{try{return await(await fetch(`${p}/jobs`)).json()}catch(a){console.log(a)}},Y=async a=>{try{return await(await fetch(`${p}/jobs/getone/${a}`)).json()}catch(t){console.log(t)}},K=async a=>{try{return await(await fetch(`${p}/graduated/visit/${a}`,x.authPostConfig())).json()}catch(t){console.log(t)}},O=async a=>{try{return await(await fetch(`${p}/graduated/postulations/save/${a}`,x.authPostConfig())).json()}catch(t){console.log(t)}},W=async a=>{try{return await(await fetch(`${p}/graduated/postulations/delete/${a}`,x.authDeleteConfig())).json()}catch(t){console.log(t)}},X=async a=>{try{return await(await fetch(`${p}/graduated/postulations/getone/${a}`,x.authGetConfig())).json()}catch(t){console.log(t)}};var f={getJobs:Q,getOneJob:Y,registerJobVisit:K,registerPostulation:O,getPostulation:X,deletePostulation:W};const Z=()=>{const[a,t]=n.exports.useState(null),[s,c]=n.exports.useState({}),[d,u]=n.exports.useState(""),[o,h]=n.exports.useState(!1),[m,w]=n.exports.useState(!1),[y,j]=n.exports.useState({}),{params:l,location:C}=P(),{verifySession:g}=E(),H=n.exports.useRef(),R=async()=>{const i=await g(()=>f.registerPostulation(l.id));if(!i.status)return b.error(i.statusText);b.success("Curriculum enviado"),N()},V=async()=>{U.fire(J({text:"\xBFDesea cancelar su postulacion?",icon:"info"},x.alertConfig)).then(async i=>{if(i.isConfirmed){const v=await g(()=>f.deletePostulation(l.id));if(!v.status)return b.error(v.statusText);b.success("Postulaci\xF3n cancelada"),N()}})},N=n.exports.useCallback(async()=>{if(!l.id)return;w(!0);const i=await g(()=>f.getPostulation(l.id));if(!i.id){j({}),t(null),w(!1);return}const v=await I.getResourcesFromPublicFolder(`graduated/cvs/${i.curriculum}`);u(v),j(i),w(!1)},[l.id]),k=n.exports.useCallback(async()=>{!l.id||await g(()=>f.registerJobVisit(l.id))},[l.id]),$=n.exports.useCallback(async()=>{if(!l.id)return;if(C.state!==null){c(C.state);return}h(!0);const i=await g(()=>f.getOneJob(l.id));c(i),h(!1)},[l.id,C.state]);return n.exports.useEffect(()=>{$(),N(),k()},[$,k,N]),n.exports.useEffect(()=>{t(null)},[s.folio]),e("div",{className:"p-2",children:o?e(S,{}):e(A,{children:s.folio?r(A,{children:[e("h3",{className:"text-primary btn-link text-left font-weight-bolder",children:s.vacante}),r("div",{className:"d-flex flex-column flex-lg-row flex-xl-row mt-3",children:[e("h5",{className:"font-weight-bold",children:s.nombre_comercial}),r("ul",{className:"custom-list",children:[e("li",{children:e("h6",{children:s.ubicacion})}),e("li",{children:r("span",{className:"badge p-2 badge-primary",children:[e("i",{className:"fas fa-clock"})," ",D(s.fecha_creacion).locale("es").fromNow()]})})]})]}),r("div",{children:[r("p",{children:[e("i",{className:"fas fa-building text-primary"}),":"," ",s.tama\u00F1o," empleados"]}),r("p",{className:"text-black",children:[" ",s.descripcion]})]}),m?e(S,{}):y!=null&&y.id?r("div",{className:"d-flex flex-column align-items-center justify-content-center mt-5",children:[e("h5",{children:"Tu curriculum ha sido enviado."}),r("h6",{children:["Estado:"," ",e("span",{className:"text-primary",children:y.status})," "]}),e(G,{title:"Mi curriculum",buttonText:"Ver mi curriculum",buttonClass:"btn btn-primary btn-lg mt-3",modalClass:"modal-dialog modal-xl modal-dialog-scrollable",buttonCloseText:"Cerrar",children:e("embed",{src:d,frameBorder:"0",width:"100%",style:{height:"100vh",width:"100%"}})}),r("button",{onClick:V,className:"btn btn-primary btn-sm mt-5 align-self-end",children:["Eliminar postulacion ",e("i",{className:"fas fa-times"})]})]}):r("div",{className:"d-flex flex-column align-items-center justify-content-center mt-5",children:[a!==null&&r("div",{"data-aos":"flip-left",className:"d-flex flex-column align-items-center justify-content-center ",children:[r("p",{children:["Archivo seleccionado: ",a==null?void 0:a.name]}),r("button",{onClick:()=>t({}),className:"btn btn-primary btn-sm",children:["Quitar ",e("i",{className:"fas fa-times"})]})]}),e("div",{className:"form-group",children:e("input",{ref:H,type:"file",onChangeCapture:i=>t(i.target.files[0]),hidden:!0})}),e("button",{onClick:R,className:"btn btn-primary btn-lg mt-3",children:a!==null?"Enviar CV":"Postularme"}),e("p",{className:"mt-4",children:"Nota: El curriculum debe estar en formato PDF"})]})]}):e("div",{className:"d-flex justify-content-center align-items-center h-50 text-black",children:e("h3",{className:"text-primary font-weight-bolder text-center",children:"\xA1Selecciona un trabajo de la lista para saber mas y postularte!"})})})})},ee=(a,t)=>{const[s,c]=n.exports.useState(!1),[d,u]=n.exports.useState([]),o=n.exports.useCallback(async()=>{c(!0);const m=await a();t?(t(m),c(!1)):(u(m),c(!1))},[a,t]),h=async()=>{await o()};return n.exports.useEffect(()=>{o()},[o]),{isLoading:s,hookData:d,refreshData:h}},ie=()=>{const{verifySession:a}=E(),t=z(),{navigate:s}=P(),{hookData:c,isLoading:d}=ee(f.getJobs),[u,o]=n.exports.useState(""),h=async()=>{if(!(await a(()=>M.getProfile())).id)return s("/profile"),b("Antes de empezar a ver trabajos completa la informacion de tu perfil.")};return n.exports.useEffect(()=>{h()},[]),e("div",{className:"mb-3",children:r("div",{ref:t,"data-aos":"flip-right",className:"col-md-12 col-lg-12 col-xl-11 mx-auto",children:[r("div",{className:"input-group w-100 mb-3",children:[e("input",{type:"text",className:"form-control bg-light",placeholder:"Buscar trabajos...","aria-label":"Search","aria-describedby":"basic-addon2",onChange:m=>o(m.target.value)}),e("div",{className:"input-group-append",children:e("button",{className:"btn btn-primary",type:"button",children:e("i",{className:"fas fa-search fa-sm"})})})]}),e("div",{className:"card shadow rounded",children:e("div",{className:"card-body",children:r("div",{className:"row",children:[e("div",{className:"col-md-5 col-lg-5 col-xl-5",children:e("div",{style:{height:"65vh"},children:e("div",{style:{overflowY:"scroll",height:"100%"},children:e(q,{isLoading:d,searchTerm:u,jobs:c})})})}),e("div",{className:"col-md-7 col-lg-7 col-xl-7",children:e(Z,{})})]})})})]})})};export{ie as default};
