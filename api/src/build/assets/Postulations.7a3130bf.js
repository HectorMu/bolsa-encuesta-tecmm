var P=Object.defineProperty;var v=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var j=(i,t,e)=>t in i?P(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,C=(i,t)=>{for(var e in t||(t={}))F.call(t,e)&&j(i,e,t[e]);if(v)for(var e of v(t))L.call(t,e)&&j(i,e,t[e]);return i};import{r,t as b}from"./vendor.b272e12a.js";import{v as x}from"./vacancies.service.c1555ea0.js";import{u as g,a as s,L as w,j as a,c as S,F as _,h as T,A as V,d as R}from"./index.eb6b2ee8.js";import{m as k,u as A}from"./moment-with-locales.02939e25.js";import{M as E}from"./Modal.5fa20ae6.js";import{S as $}from"./sweetalert2.24b5b669.js";import{L as D}from"./ListButtons.756e6d58.js";const G=({postulations:i,isLoading:t})=>{const{navigate:e,params:n}=g(),l=o=>e(`/company/jobbank/postulations/${n.job_id}/${o.id}`,{state:o});return s("div",{children:t?s(w,{}):i.length>0?i.map(o=>a("div",{onClick:()=>l(o),style:{cursor:"pointer"},className:`card rounded-0 pt-3 px-3 border-left-0 border-right-0   ${parseInt(n.postulation_id)===o.id?"bg-green-light shadow ":""}`,children:[a("h5",{className:"text-primary font-weight-bolder",children:["Postulacion No. ",o.id]}),s("h6",{className:" font-weight-bolder",children:o.nombre_completo}),s("div",{className:"d-flex justify-content-end align-items-end h-100 mt-2",children:s("p",{children:s("span",{className:"badge badge-primary px-1 py-1",children:o.status})})})]},o.id)):s("h5",{className:"text-center",children:"Aqui apareceran las postulaciones recientes"})})},B=({refreshData:i})=>{const{verifySession:t}=S(),[e,n]=r.exports.useState(!1),[l,o]=r.exports.useState({}),{params:c,navigate:u,location:h}=g(),p=r.exports.useRef(),N=async()=>{$.fire(C({text:`\xBFConfirma la revisi\xF3n de la postulaci\xF3n No. ${l.id} del usuario '${l.nombre_completo}'?`,icon:"info"},T.alertConfig)).then(async m=>{if(m.isConfirmed){const y=await t(()=>x.FlagPostulationAsReviewed(l.id));if(!y.status)return b.error(y.statusText);b.success(y.statusText),await d(),await i()}})},d=r.exports.useCallback(async()=>{if(!c.postulation_id)return;n(!0);const m=await t(()=>x.GetOnePostulation(c.postulation_id));if(!m.id){b.error("Esta postulacion ya no existe."),n(!1),u(`/company/jobbank/postulations/${c.job_id}`);return}o(m),n(!1)},[c.postulation_id]),f=async()=>{if(!l.id)return;const m=await V.getResourcesFromPublicFolder(`graduated/cvs/${l.curriculum}`);console.log(m),p.current.src=m};return r.exports.useEffect(()=>{if(h.state!==null){o(h.state);return}d()},[d]),r.exports.useEffect(()=>{f()},[l.curriculum]),s("div",{children:c.postulation_id?s(_,{children:e?s(w,{}):a(_,{children:[a("div",{className:"d-flex flex-column flex-md-row justify-content-between p-2 border-light border shadow align-items-center h-100",children:[a("h6",{children:["Estado:"," ",s("span",{className:"text-primary",children:l.status})]}),l.status!=="Revisado"&&a("button",{onClick:N,className:"btn btn-primary btn-sm rounded-pill",children:[s("i",{className:"fas fa-check "})," Marcar revisado"]})]}),a("div",{className:"mt-3",children:[s("h4",{className:"text-primary font-weight-bold",children:l.nombre_completo}),s("h5",{children:l.correo}),a("h5",{children:[a("span",{className:" font-weight-bold text-primary",children:["Telefono 1:"," "]}),l.telefono]}),a("h5",{children:[" ",a("span",{className:" font-weight-bold text-primary",children:["Telefono 2:"," "]})," ",l.tel_casa]})]}),s("div",{className:"d-flex   justify-content-center mt-5",children:s(E,{title:"Curriculum",buttonText:"Ver curriculum",buttonClass:"btn btn-primary btn-lg mt-3",modalClass:"modal-dialog modal-xl modal-dialog-scrollable",buttonCloseText:"Cerrar",children:s("embed",{ref:p,frameBorder:"0",width:"100%",style:{height:"100vh",width:"100%"}})})})]})}):s("h2",{className:"text-center font-weight-bolder text-primary",children:"Selecciona un elemento de la lista"})})},H=()=>{const[i,t]=r.exports.useState({}),[e,n]=r.exports.useState({}),[l,o]=r.exports.useState(!0),{verifySession:c}=S(),{params:u,navigate:h}=g(),p=()=>h("/company/jobbank/"),N=()=>o(!l),d=r.exports.useCallback(async()=>{t(!0);const f=await c(()=>x.GetOne(u.job_id));if(!f.folio){b.error("Esta vacante no existe."),h("/company/jobbank");return}n(f),t(!1)},[u.job_id]);return r.exports.useEffect(()=>{d()},[d]),s("div",{"data-aos":"flip-right",className:"col-lg-8 mx-auto mb-4",children:i?s(w,{}):a("div",{className:"card p-3 shadow-lg",children:[a("div",{className:"row",children:[s("div",{className:"col-12 h-100",children:a("div",{className:"d-flex justify-content-between align-items-center",children:[a("button",{onClick:p,className:"btn ",children:[" ",s("i",{className:"fas fa-arrow-left text-primary"})]}),a("h6",{className:"text-primary font-weight-bold",children:["Folio: ",e==null?void 0:e.folio]}),s(D,{object:e,refreshCallback:d})]})}),a("div",{className:"col-6",children:[s("h5",{className:"text-primary font-weight-bold",children:e==null?void 0:e.vacante}),s("p",{className:"text-primary ",children:e==null?void 0:e.ubicacion})]}),s("div",{className:"col-6"})]}),a("div",{className:"d-flex  justify-content-between align-items-end h-100",children:[a("div",{className:"d-flex flex-column flex-sm-column flex-md-column flex-lg-column flex-xl-row",children:[s("p",{children:a("span",{className:"badge badge-pill badge-primary mr-0 mr-xl-2  px-4",children:[s("i",{className:"fas fa-eye"})," ",e==null?void 0:e.visitas," ",(e==null?void 0:e.visitas)===1?"Visita":"Visitas"]})}),s("p",{children:a("span",{className:"badge badge-pill badge-primary  mr-0 mr-xl-2 py-1 px-4",children:[s("i",{className:"fas fa-envelope"})," ",e==null?void 0:e.solicitudes," ",(e==null?void 0:e.solicitudes)===1?"Solicitud":"Solicitudes"]})}),s("p",{children:a("span",{className:"badge badge-pill badge-primary ml-0 ml-xl-2 py-1 px-4",children:[(e==null?void 0:e.status)==="Abierta"?s("i",{className:"fas fa-lock-open"}):s("i",{className:"fas fa-lock"})," ",e==null?void 0:e.status]})})]}),a("div",{className:"d-flex flex-column flex-md-row",onClick:N,style:{cursor:"pointer"},children:[s("p",{children:a("span",{className:"badge badge-pill badge-primary mr-0 mr-md-2  py-1",children:["Publicado:"," ",l?k(e==null?void 0:e.fecha_creacion).locale("es").fromNow():e==null?void 0:e.fecha_creacion]})}),s("p",{children:a("span",{className:"badge badge-pill badge-primary  py-1",children:["Expira:"," ",l?k(e==null?void 0:e.fecha_expira).locale("es").fromNow():e==null?void 0:e.fecha_expira]})})]})]})]})})},Q=()=>{const{params:i}=g(),{hookData:t,refreshData:e,isLoading:n}=R(()=>x.GetPostulations(i.job_id),[i.job_id]);return a("div",{className:"container-fluid mb-3",children:[s(H,{}),s("div",{ref:A(),"data-aos":"flip-down",className:"col-xl-10 mx-auto",children:s("div",{className:"card shadow rounded",children:s("div",{className:"card-body",children:a("div",{className:"row",children:[s("div",{className:"col-md-5 col-lg-5 col-xl-5",children:s("div",{style:{height:"65vh"},children:s("div",{style:{overflowY:"scroll",height:"100%"},children:s(G,{isLoading:n,postulations:t})})})}),s("div",{className:"col-md-7 col-lg-7 col-xl-7",children:s(B,{postulations:t,refreshData:e})})]})})})})]})};export{Q as default};
